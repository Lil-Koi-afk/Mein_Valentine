<!DOCTYPE html>
<html lang="de">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
<title>F√ºr Dich ‚ô•</title>
<link href="https://fonts.googleapis.com/css2?family=Playfair+Display:ital,wght@0,400;0,700;1,400&family=Quicksand:wght@300;400;500;600&family=Great+Vibes&display=swap" rel="stylesheet">
<style>
*,*::before,*::after{margin:0;padding:0;box-sizing:border-box}
:root{
  --rose:#c9184a;--rose-light:#ff4d6d;--rose-dark:#800f2f;
  --pink:#ffb3c6;--pink-soft:#fff0f3;--cream:#fff5f7;
  --gold:#d4a373;--gold-light:#e9c46a;
  --text:#3d0814;--text-light:#6b2737;--white:#fff;
  --err:#dc2626;--ok:#16a34a;
}
body{font-family:'Quicksand',sans-serif;background:var(--cream);min-height:100vh;min-height:100dvh;overflow-x:hidden;color:var(--text)}

.hearts-bg{position:fixed;inset:0;pointer-events:none;z-index:0;overflow:hidden}
.fh{position:absolute;opacity:.12;color:var(--rose);animation:floatUp linear infinite}
@keyframes floatUp{0%{transform:translateY(110vh) rotate(0) scale(1);opacity:0}10%{opacity:.12}90%{opacity:.12}100%{transform:translateY(-10vh) rotate(360deg) scale(.5);opacity:0}}

.page{display:none;min-height:100vh;min-height:100dvh;position:relative;z-index:1}
.page.active{display:flex}

@keyframes fadeInUp{from{opacity:0;transform:translateY(30px)}to{opacity:1;transform:translateY(0)}}
@keyframes heartbeat{0%,100%{transform:scale(1)}15%{transform:scale(1.15)}30%{transform:scale(1)}45%{transform:scale(1.1)}}
@keyframes shake{10%,90%{transform:translate3d(-2px,0,0)}20%,80%{transform:translate3d(4px,0,0)}30%,50%,70%{transform:translate3d(-6px,0,0)}40%,60%{transform:translate3d(6px,0,0)}}
@keyframes confettiFall{0%{opacity:1;transform:translateY(-20vh) rotate(0)}100%{opacity:0;transform:translateY(110vh) rotate(720deg)}}
@keyframes pulse{0%,100%{opacity:.6}50%{opacity:1}}
@keyframes popIn{0%{transform:scale(0) rotate(-10deg);opacity:0}60%{transform:scale(1.2) rotate(3deg)}100%{transform:scale(1) rotate(0);opacity:1}}
@keyframes glow{0%,100%{box-shadow:0 0 20px rgba(201,24,74,.2)}50%{box-shadow:0 0 40px rgba(201,24,74,.4)}}
@keyframes float{0%,100%{transform:translateY(0)}50%{transform:translateY(-10px)}}
@keyframes sparkle{0%,100%{opacity:0;transform:scale(0)}50%{opacity:1;transform:scale(1)}}

/* Password */
#passwordPage{flex-direction:column;align-items:center;justify-content:center;padding:2rem;text-align:center;background:radial-gradient(ellipse at 50% 30%,rgba(255,77,109,.06) 0%,transparent 70%)}
.pw-wrap{max-width:400px;width:100%;animation:fadeInUp .8s ease-out}
.pw-heart{font-size:3rem;margin-bottom:1rem;display:inline-block;animation:heartbeat 1.5s ease-in-out infinite}
.pw-title{font-family:'Great Vibes',cursive;font-size:clamp(1.8rem,5vw,2.8rem);color:var(--rose);margin-bottom:.3rem}
.pw-sub{font-family:'Playfair Display',serif;font-style:italic;color:var(--text-light);font-size:.95rem;margin-bottom:2rem}
.pw-input{width:100%;padding:1rem 1.2rem;border:2px solid var(--pink);border-radius:14px;font-family:'Quicksand',sans-serif;font-size:1.1rem;text-align:center;outline:none;background:var(--white);transition:all .3s;letter-spacing:2px}
.pw-input:focus{border-color:var(--rose);box-shadow:0 0 0 4px rgba(201,24,74,.1)}
.pw-input.error{border-color:var(--err);animation:shake .5s}
.pw-btn{width:100%;padding:.9rem;margin-top:.8rem;background:linear-gradient(135deg,var(--rose),var(--rose-light));color:#fff;border:none;border-radius:14px;font-family:'Quicksand',sans-serif;font-weight:600;font-size:1rem;cursor:pointer;transition:all .3s}
.pw-btn:hover{transform:translateY(-2px);box-shadow:0 6px 20px rgba(201,24,74,.3)}
.pw-err{color:var(--err);font-size:.85rem;margin-top:.6rem;min-height:1.2rem}

/* Welcome */
#welcomePage{flex-direction:column;align-items:center;justify-content:center;text-align:center;padding:2rem;background:radial-gradient(ellipse at 50% 30%,rgba(255,77,109,.08) 0%,transparent 70%)}
.wc{max-width:520px;animation:fadeInUp 1s ease-out}
.wc-heart{font-size:4rem;margin-bottom:1rem;animation:heartbeat 1.5s ease-in-out infinite;display:inline-block}
.wc-title{font-family:'Great Vibes',cursive;font-size:clamp(2.2rem,6vw,3.8rem);color:var(--rose);margin-bottom:.5rem;line-height:1.3}
.wc-sub{font-family:'Playfair Display',serif;font-size:clamp(1rem,2.5vw,1.3rem);color:var(--text-light);margin-bottom:2rem;font-weight:400;line-height:1.6;font-style:italic}
.wc-div{width:60px;height:2px;background:linear-gradient(90deg,transparent,var(--gold),transparent);margin:1.5rem auto}
.start-btn{padding:.9rem 2.5rem;font-size:1rem;border-radius:14px;background:linear-gradient(135deg,var(--rose),var(--rose-light));color:#fff;border:none;font-family:'Quicksand',sans-serif;font-weight:600;cursor:pointer;transition:all .3s}
.start-btn:hover{transform:translateY(-2px);box-shadow:0 6px 20px rgba(201,24,74,.3)}

/* ===== MINI GAMES ===== */
.game-page{flex-direction:column;align-items:center;justify-content:center;padding:1.5rem;text-align:center;background:radial-gradient(ellipse at 50% 30%,rgba(255,77,109,.06) 0%,transparent 70%)}
.game-wrap{max-width:500px;width:100%}
.game-step{font-size:.8rem;color:var(--gold);font-weight:600;letter-spacing:2px;text-transform:uppercase;margin-bottom:.5rem}
.game-title{font-family:'Playfair Display',serif;font-size:clamp(1.3rem,3.5vw,1.8rem);color:var(--text);margin-bottom:.3rem;font-weight:700}
.game-desc{color:var(--text-light);font-size:.9rem;margin-bottom:1.5rem;line-height:1.5}
.game-card{background:var(--white);border-radius:20px;padding:2rem 1.5rem;box-shadow:0 8px 30px rgba(201,24,74,.08);border:1px solid rgba(255,179,198,.3)}

/* Game 1: Heart Catcher */
.catch-area{width:100%;height:300px;position:relative;overflow:hidden;border-radius:16px;background:linear-gradient(180deg,var(--pink-soft),var(--cream));touch-action:none;cursor:pointer;user-select:none}
.catch-heart{position:absolute;font-size:1.8rem;cursor:pointer;transition:transform .1s;user-select:none;z-index:2}
.catch-heart:hover{transform:scale(1.3)}
.catch-score{font-family:'Playfair Display',serif;font-size:1.2rem;color:var(--rose);margin-top:1rem;font-weight:600}
.catch-progress{width:100%;height:6px;background:var(--pink);border-radius:10px;margin-top:.8rem;overflow:hidden}
.catch-fill{height:100%;background:linear-gradient(90deg,var(--rose),var(--gold-light));border-radius:10px;transition:width .3s;width:0}
.sparkle-burst{position:absolute;pointer-events:none;font-size:1rem;animation:sparkle .6s ease-out forwards}

/* Game 2: Love Letter Puzzle */
.letter-slots{display:flex;gap:.4rem;justify-content:center;flex-wrap:wrap;margin-bottom:1.5rem;min-height:50px}
.letter-slot{width:38px;height:44px;border:2px dashed var(--pink);border-radius:8px;display:flex;align-items:center;justify-content:center;font-family:'Playfair Display',serif;font-size:1.2rem;font-weight:700;color:var(--rose);transition:all .3s}
.letter-slot.filled{border:2px solid var(--rose);background:var(--pink-soft)}
.letter-slot.correct{border-color:var(--ok);background:#dcfce7;color:#166534}
.letter-slot.wrong{border-color:var(--err);background:#fee2e2;color:#991b1b;animation:shake .4s}
.letter-choices{display:flex;gap:.4rem;justify-content:center;flex-wrap:wrap}
.letter-btn{width:40px;height:44px;border:2px solid var(--pink);border-radius:8px;background:var(--white);font-family:'Playfair Display',serif;font-size:1.1rem;font-weight:700;color:var(--text);cursor:pointer;transition:all .3s;display:flex;align-items:center;justify-content:center}
.letter-btn:hover{background:var(--pink);transform:translateY(-2px)}
.letter-btn.used{opacity:.3;pointer-events:none}

/* Game 3: Herz zeichnen (connect dots) */
.draw-area{width:100%;max-width:320px;margin:0 auto;aspect-ratio:1;position:relative}
.draw-canvas{width:100%;height:100%;border-radius:16px;touch-action:none;cursor:crosshair}
.draw-hint{color:var(--text-light);font-size:.8rem;margin-top:.8rem}
.draw-progress{font-family:'Playfair Display',serif;font-size:1.1rem;color:var(--rose);margin-top:.8rem;font-weight:600}

/* Quiz */
#quizPage{flex-direction:column;align-items:center;justify-content:center;padding:2rem;background:radial-gradient(ellipse at 50% 30%,rgba(255,77,109,.06) 0%,transparent 70%)}
.qz{max-width:500px;width:100%;text-align:center}
.prog-wrap{margin-bottom:2rem}
.prog-label{font-size:.8rem;color:var(--text-light);margin-bottom:.5rem;font-weight:500}
.prog-bg{width:100%;height:8px;background:var(--pink);border-radius:10px;overflow:hidden}
.prog-fill{height:100%;border-radius:10px;width:0;background:linear-gradient(90deg,var(--rose),var(--rose-light),var(--gold-light));transition:width .6s cubic-bezier(.4,0,.2,1)}
.q-card{background:var(--white);border-radius:20px;padding:2.5rem 2rem;box-shadow:0 8px 30px rgba(201,24,74,.08);border:1px solid rgba(255,179,198,.3);transition:all .3s}
.q-card.shake{animation:shake .6s cubic-bezier(.36,.07,.19,.97) both}
.q-card.wrong{border-color:var(--err);box-shadow:0 8px 30px rgba(220,38,38,.15);background:#fff5f5}
.q-num{font-family:'Great Vibes',cursive;font-size:1.4rem;color:var(--gold);margin-bottom:.5rem}
.q-text{font-family:'Playfair Display',serif;font-size:clamp(1.1rem,3vw,1.4rem);color:var(--text);margin-bottom:1.8rem;line-height:1.5;font-weight:600}
.a-grid{display:flex;flex-direction:column;gap:.7rem}
.a-btn{padding:.9rem 1.2rem;background:var(--pink-soft);border:2px solid var(--pink);border-radius:12px;font-family:'Quicksand',sans-serif;font-size:1rem;font-weight:500;color:var(--text);cursor:pointer;transition:all .3s}
.a-btn:hover{background:var(--pink);border-color:var(--rose-light);transform:translateY(-2px);box-shadow:0 4px 12px rgba(201,24,74,.15)}
.a-btn.correct{background:#dcfce7;border-color:var(--ok);color:#166534}
.a-btn.incorrect{background:#fee2e2;border-color:var(--err);color:#991b1b}

/* Reward */
#rewardPage{flex-direction:column;align-items:center;justify-content:center;padding:2rem;text-align:center;background:radial-gradient(ellipse at 50% 30%,rgba(212,163,115,.1) 0%,transparent 70%)}
.rw{max-width:500px;animation:fadeInUp 1s ease-out}
.rw-emoji{font-size:3.5rem;margin-bottom:1rem;animation:heartbeat 1.5s ease-in-out infinite;display:inline-block}
.rw-title{font-family:'Great Vibes',cursive;font-size:clamp(2rem,5vw,3rem);color:var(--rose);margin-bottom:.5rem}
.rw-sub{font-family:'Playfair Display',serif;font-style:italic;color:var(--text-light);margin-bottom:2rem;font-size:1.1rem}
.rw-card{background:var(--white);border-radius:20px;padding:2.5rem 2rem;box-shadow:0 8px 30px rgba(212,163,115,.15);border:2px solid var(--gold);position:relative;overflow:hidden}
.rw-card::before{content:'';position:absolute;top:0;left:0;right:0;height:4px;background:linear-gradient(90deg,var(--gold),var(--gold-light),var(--gold))}
.gift-label{font-size:.85rem;text-transform:uppercase;letter-spacing:3px;color:var(--gold);margin-bottom:1rem;font-weight:600}
.gift-text{font-family:'Playfair Display',serif;font-size:clamp(1.3rem,3.5vw,1.8rem);color:var(--text);line-height:1.6;font-weight:600}
.rw-footer{margin-top:2rem;font-family:'Great Vibes',cursive;font-size:1.5rem;color:var(--rose-light)}
.confetti{position:fixed;z-index:1000;pointer-events:none;animation:confettiFall linear forwards}

/* Transition overlay */
.transition-overlay{position:fixed;inset:0;z-index:500;display:flex;align-items:center;justify-content:center;background:var(--cream);opacity:0;pointer-events:none;transition:opacity .4s}
.transition-overlay.active{opacity:1;pointer-events:auto}
.transition-msg{font-family:'Great Vibes',cursive;font-size:clamp(1.5rem,4vw,2.5rem);color:var(--rose);animation:popIn .6s ease-out}

/* Admin */
#adminPage{flex-direction:column;padding:1.5rem;min-height:100vh;background:#fafafa}
.adm-head{display:flex;align-items:center;justify-content:space-between;margin-bottom:1.5rem;flex-wrap:wrap;gap:1rem}
.adm-title{font-family:'Playfair Display',serif;font-size:1.5rem;color:var(--rose-dark)}
.adm-acts{display:flex;gap:.5rem;flex-wrap:wrap;align-items:center}
.btn{padding:.6rem 1.2rem;border:none;border-radius:10px;font-family:'Quicksand',sans-serif;font-weight:600;font-size:.85rem;cursor:pointer;transition:all .3s}
.btn-p{background:linear-gradient(135deg,var(--rose),var(--rose-light));color:#fff}
.btn-p:hover{box-shadow:0 4px 12px rgba(201,24,74,.3);transform:translateY(-1px)}
.btn-s{background:var(--white);color:var(--text);border:2px solid #e5e5e5}
.btn-s:hover{border-color:var(--rose)}
.btn-d{background:#fee2e2;color:var(--err)}.btn-d:hover{background:#fecaca}
.btn-ok{background:linear-gradient(135deg,var(--ok),#22c55e);color:#fff}
.btn-ok:hover{box-shadow:0 4px 12px rgba(22,163,74,.3)}
.adm-sec{background:var(--white);border-radius:16px;padding:1.5rem;margin-bottom:1.2rem;box-shadow:0 2px 10px rgba(0,0,0,.04);border:1px solid #f0f0f0}
.adm-sec h3{font-family:'Playfair Display',serif;font-size:1.1rem;color:var(--text);margin-bottom:1rem;padding-bottom:.5rem;border-bottom:1px solid #f0f0f0}
.adm-sec label{display:block;font-size:.85rem;font-weight:600;color:var(--text-light);margin-bottom:.3rem;margin-top:.8rem}
.adm-sec label:first-of-type{margin-top:0}
.ai,.at{width:100%;padding:.7rem 1rem;border:2px solid #e5e5e5;border-radius:10px;font-family:'Quicksand',sans-serif;font-size:.9rem;outline:none;transition:border-color .3s}
.ai:focus,.at:focus{border-color:var(--rose)}
.at{resize:vertical;min-height:80px}
.q-list{display:flex;flex-direction:column;gap:1rem}
.q-item{background:var(--pink-soft);border-radius:12px;padding:1.2rem;border:1px solid var(--pink)}
.q-item-head{display:flex;justify-content:space-between;align-items:flex-start;margin-bottom:.5rem}
.q-item-num{font-family:'Great Vibes',cursive;font-size:1.2rem;color:var(--rose)}
.q-item-acts{display:flex;gap:.3rem}
.btn-sm{padding:.3rem .7rem;font-size:.75rem;border-radius:8px}
.q-item-text{font-weight:600;margin-bottom:.4rem;color:var(--text)}
.q-item-ans{font-size:.85rem;color:var(--text-light)}
.q-item-ans .ca{color:var(--ok);font-weight:600}
.q-form{background:var(--cream);border-radius:12px;padding:1.2rem;margin-top:1rem;border:2px dashed var(--pink);display:none}
.q-form.show{display:block}
.a-row{display:flex;gap:.5rem;align-items:center;margin-bottom:.5rem}
.a-row input[type="text"]{flex:1;padding:.5rem .8rem;border:2px solid #e5e5e5;border-radius:8px;font-family:'Quicksand',sans-serif;font-size:.85rem;outline:none}
.a-row input[type="text"]:focus{border-color:var(--rose)}
.a-row input[type="radio"]{accent-color:var(--rose);width:18px;height:18px;cursor:pointer}
.rm-btn{background:none;border:none;color:#aaa;font-size:1.2rem;cursor:pointer;padding:.2rem}
.rm-btn:hover{color:var(--err)}
.toast{position:fixed;bottom:2rem;left:50%;transform:translateX(-50%) translateY(100px);background:var(--text);color:#fff;padding:.8rem 1.5rem;border-radius:12px;font-family:'Quicksand',sans-serif;font-weight:600;font-size:.9rem;z-index:10000;transition:transform .4s cubic-bezier(.4,0,.2,1);box-shadow:0 8px 25px rgba(0,0,0,.2)}
.toast.show{transform:translateX(-50%) translateY(0)}
.save-st{font-size:.8rem;color:var(--ok);font-weight:500;opacity:0;transition:opacity .3s}
.save-st.v{opacity:1}

@media(max-width:600px){
  .adm-head{flex-direction:column;align-items:flex-start}
  .q-card,.rw-card,.game-card{padding:1.8rem 1.2rem}
  .catch-area{height:250px}
  .letter-btn,.letter-slot{width:34px;height:40px;font-size:1rem}
}
</style>
</head>
<body>

<div class="hearts-bg" id="hbg"></div>

<!-- TRANSITION OVERLAY -->
<div class="transition-overlay" id="transOv">
  <div class="transition-msg" id="transMsg"></div>
</div>

<!-- PASSWORD -->
<div class="page active" id="passwordPage">
  <div class="pw-wrap">
    <div class="pw-heart">üíï</div>
    <h1 class="pw-title">F√ºr Dich</h1>
    <p class="pw-sub">Gib das Passwort ein, um fortzufahren...</p>
    <input type="text" class="pw-input" id="pwIn" placeholder="‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢" autocomplete="off" maxlength="30">
    <button class="pw-btn" onclick="checkPw()">√ñffnen ‚ô•</button>
    <div class="pw-err" id="pwErr"></div>
  </div>
</div>

<!-- WELCOME -->
<div class="page" id="welcomePage">
  <div class="wc">
    <div class="wc-heart">üíï</div>
    <h1 class="wc-title" id="wcTitle"></h1>
    <div class="wc-div"></div>
    <p class="wc-sub" id="wcSub"></p>
    <button class="start-btn" onclick="startGames()">Los geht's!</button>
  </div>
</div>

<!-- GAME 1: HEART CATCHER -->
<div class="page game-page" id="game1Page">
  <div class="game-wrap" style="animation:fadeInUp .6s ease-out">
    <div class="game-step">Challenge 1 von 3</div>
    <div class="game-title">Fang die Herzen! üíï</div>
    <div class="game-desc">Tippe auf die fallenden Herzen. Du brauchst 15 Herzen!</div>
    <div class="game-card">
      <div class="catch-area" id="catchArea"></div>
      <div class="catch-score">Gefangen: <span id="catchCount">0</span> / 15</div>
      <div class="catch-progress"><div class="catch-fill" id="catchFill"></div></div>
    </div>
  </div>
</div>

<!-- GAME 2: LOVE LETTER UNSCRAMBLE -->
<div class="page game-page" id="game2Page">
  <div class="game-wrap" style="animation:fadeInUp .6s ease-out">
    <div class="game-step">Challenge 2 von 3</div>
    <div class="game-title">Liebesbrief entziffern üíå</div>
    <div class="game-desc">Bringe die Buchstaben in die richtige Reihenfolge!</div>
    <div class="game-card">
      <div class="letter-slots" id="letterSlots"></div>
      <div style="height:1px;background:var(--pink);margin:1rem 0"></div>
      <div class="letter-choices" id="letterChoices"></div>
    </div>
  </div>
</div>

<!-- GAME 3: DRAW A HEART -->
<div class="page game-page" id="game3Page">
  <div class="game-wrap" style="animation:fadeInUp .6s ease-out">
    <div class="game-step">Challenge 3 von 3</div>
    <div class="game-title">Male ein Herz! üé®</div>
    <div class="game-desc">Verbinde alle Punkte der Reihe nach, um ein Herz zu zeichnen!</div>
    <div class="game-card">
      <div class="draw-area">
        <canvas class="draw-canvas" id="drawCanvas"></canvas>
      </div>
      <div class="draw-progress">Punkte verbunden: <span id="dotCount">0</span> / <span id="dotTotal">0</span></div>
      <div class="draw-hint">Tippe oder klicke auf den n√§chsten leuchtenden Punkt!</div>
    </div>
  </div>
</div>

<!-- QUIZ -->
<div class="page" id="quizPage">
  <div class="qz">
    <div class="prog-wrap">
      <div class="prog-label" id="progLbl"></div>
      <div class="prog-bg"><div class="prog-fill" id="progFill"></div></div>
    </div>
    <div class="q-card" id="qCard">
      <div class="q-num" id="qNum"></div>
      <div class="q-text" id="qText"></div>
      <div class="a-grid" id="aGrid"></div>
    </div>
  </div>
</div>

<!-- REWARD -->
<div class="page" id="rewardPage">
  <div class="rw">
    <div class="rw-emoji">üéÅ</div>
    <h1 class="rw-title">Du hast es geschafft!</h1>
    <p class="rw-sub">Alle Challenges & Fragen gemeistert ‚ô•</p>
    <div class="rw-card">
      <div class="gift-label">‚ú¶ Dein Geschenk ‚ú¶</div>
      <div class="gift-text" id="giftText"></div>
    </div>
    <div class="rw-footer">‚ô•</div>
  </div>
</div>

<!-- ADMIN -->
<div class="page" id="adminPage">
  <div class="adm-head">
    <h1 class="adm-title">‚ô• Admin Backend</h1>
    <div class="adm-acts">
      <span class="save-st" id="saveSt">‚úì Gespeichert</span>
      <button class="btn btn-ok" onclick="saveAll()">üíæ Speichern</button>
      <button class="btn btn-s" onclick="preview()">üëÅ Vorschau</button>
      <button class="btn btn-s" onclick="logout()">Logout</button>
    </div>
  </div>
  <div class="adm-sec"><h3>Willkommens-Seite</h3>
    <label>Titel</label><input type="text" class="ai" id="admTitle">
    <label>Untertitel</label><textarea class="at" id="admSub"></textarea>
  </div>
  <div class="adm-sec"><h3>Geschenk-Text</h3>
    <label>Was ist das Geschenk?</label><textarea class="at" id="admGift"></textarea>
  </div>
  <div class="adm-sec"><h3>Passw√∂rter</h3>
    <label>Quiz-Passwort (f√ºr sie)</label><input type="text" class="ai" id="admPwQuiz">
    <label>Admin-Passwort (f√ºr dich)</label><input type="text" class="ai" id="admPwAdmin">
  </div>
  <div class="adm-sec"><h3>Fragen</h3>
    <div class="q-list" id="qList"></div>
    <button class="btn btn-p" style="margin-top:1rem;width:100%" onclick="showAddForm()">+ Neue Frage</button>
    <div class="q-form" id="qForm">
      <label>Frage</label><input type="text" class="ai" id="fqText" placeholder="z.B. Wie hei√üt mein Hund?">
      <label>Antworten <span style="font-weight:400;color:#aaa">(richtige ausw√§hlen ‚óè)</span></label>
      <div id="fAnswers"></div>
      <button class="btn btn-s btn-sm" style="margin-top:.5rem" onclick="addAField()">+ Antwort</button>
      <div style="display:flex;gap:.5rem;margin-top:1rem">
        <button class="btn btn-ok" onclick="saveQ()">Speichern</button>
        <button class="btn btn-s" onclick="cancelForm()">Abbrechen</button>
      </div>
    </div>
  </div>
</div>

<div class="toast" id="toast"></div>

<script>
/* ===== DEFAULT DATA ===== */
const DEFAULTS = {
  welcomeTitle: "Sch√∂n, dass du mich als dein Valentin ausgew√§hlt hast",
  welcomeSubtitle: "Hier kommt dein Geschenk... aber du musst davor noch ein paar Challenges & Fragen meistern!",
  giftText: "Eine √ñl Massage im Kerzenschein",
  quizPassword: "06.10.2025",
  adminPassword: "28.08.2001",
  questions: [
    { text:"An welcher S-Bahn Station haben wir uns das erste Mal getroffen?", answers:["Friedrichstra√üe","Olympiastadion","Alexanderplatz","Westkreuz"], correct:1 },
    { text:"Warum h√§lt die Lampe nicht?", answers:["Der Kleber ist schlecht","Kai hat Mist gebaut"], correct:0 },
    { text:"Was ist unser Lied?", answers:["Hells Bells","Another Day in Paradise","Atemlos","Perfect"], correct:1 },
    { text:"Hochstra√üe wie viel?", answers:["12","39","173","7"], correct:3 },
    { text:"Wo hatten wir unseren ersten Kuss?", answers:["Redaktion","Couch","Nothaltebucht","Balkon"], correct:1 },
    { text:"Wie hei√üt mein Hund?", answers:["Theo","Holly","Molly","Bella"], correct:1 },
    { text:"Wer hat zuerst \"Ich liebe dich\" gesagt?", answers:["Kai","Anna"], correct:1 },
    { text:"Wie viele Weingl√§ser stehen bei uns zu Hause auf dem Tisch?", answers:["Eins","Zwei"], correct:0 },
    { text:"Dort oder Dorte?", answers:["Dort","Dorte"], correct:1 },
    { text:"Welches Gericht kocht Kai nur wegen dir?", answers:["Bami Goreng","Pasta","Reistopf","Reispfanne"], correct:3 }
  ]
};

let D={}, curQ=0, editIdx=-1;

/* Storage */
function sGet(k){try{const v=localStorage.getItem(k);return v?JSON.parse(v):null}catch{return null}}
function sSet(k,v){try{localStorage.setItem(k,JSON.stringify(v));return true}catch{return false}}

function loadData(){
  const s=sGet('vq_data');
  if(s&&s.questions&&s.questions.length) D={...JSON.parse(JSON.stringify(DEFAULTS)),...s};
  else D=JSON.parse(JSON.stringify(DEFAULTS));
  apply();
}
function apply(){
  document.getElementById('wcTitle').textContent=D.welcomeTitle;
  document.getElementById('wcSub').textContent=D.welcomeSubtitle;
  document.getElementById('giftText').textContent=D.giftText;
}

/* Pages */
function showP(id){document.querySelectorAll('.page').forEach(p=>p.classList.remove('active'));document.getElementById(id).classList.add('active')}

function transitionTo(msg,pageId,delay=1500){
  const ov=document.getElementById('transOv'),m=document.getElementById('transMsg');
  m.textContent=msg;ov.classList.add('active');
  setTimeout(()=>{showP(pageId);setTimeout(()=>ov.classList.remove('active'),400)},delay);
}

/* Password */
function checkPw(){
  const v=document.getElementById('pwIn').value.trim(),e=document.getElementById('pwErr'),i=document.getElementById('pwIn');
  if(v===D.adminPassword){e.textContent='';showP('adminPage');popAdmin()}
  else if(v===D.quizPassword){e.textContent='';showP('welcomePage')}
  else{e.textContent='Falsches Passwort! Versuch es nochmal ‚ô•';i.classList.add('error');vib();setTimeout(()=>i.classList.remove('error'),600)}
}

/* ===== GAME FLOW ===== */
function startGames(){transitionTo('Challenge 1: Fang die Herzen! üíï','game1Page');setTimeout(initGame1,1600)}

/* --- GAME 1: HEART CATCHER --- */
let catchScore=0,catchInterval,catchTarget=15;
function initGame1(){
  catchScore=0;updCatch();
  const area=document.getElementById('catchArea');area.innerHTML='';
  catchInterval=setInterval(()=>{
    if(catchScore>=catchTarget)return;
    const h=document.createElement('div');h.className='catch-heart';
    h.textContent=['üíï','üíó','‚ù§Ô∏è','üíñ','‚ô•Ô∏è'][Math.floor(Math.random()*5)];
    h.style.left=Math.random()*85+'%';h.style.top='-40px';
    h.style.fontSize=(1.4+Math.random()*.8)+'rem';
    let py=-40,speed=1.5+Math.random()*2;
    h.addEventListener('pointerdown',e=>{
      e.preventDefault();
      catchScore++;updCatch();
      // sparkle burst
      for(let i=0;i<5;i++){
        const sp=document.createElement('div');sp.className='sparkle-burst';
        sp.textContent='‚ú®';sp.style.left=(parseFloat(h.style.left)+Math.random()*10-5)+'%';
        sp.style.top=(py+Math.random()*20-10)+'px';
        area.appendChild(sp);setTimeout(()=>sp.remove(),600);
      }
      h.remove();
      if(catchScore>=catchTarget){clearInterval(catchInterval);
        setTimeout(()=>transitionTo('Super gemacht! üåü Weiter geht\'s...','game2Page',1200),500);
        setTimeout(initGame2,1800);
      }
    });
    area.appendChild(h);
    function fall(){
      if(!h.parentElement)return;
      py+=speed;h.style.top=py+'px';
      if(py>320)h.remove();else requestAnimationFrame(fall);
    }
    fall();
  },400);
}
function updCatch(){
  document.getElementById('catchCount').textContent=catchScore;
  document.getElementById('catchFill').style.width=(catchScore/catchTarget*100)+'%';
}

/* --- GAME 2: LOVE LETTER UNSCRAMBLE --- */
const LOVE_WORDS=["LIEBE","HERZ","KUSS","IMMER","TRAUM"];
let curWord,curLetters,curSlot;
function initGame2(){
  curWord=LOVE_WORDS[Math.floor(Math.random()*LOVE_WORDS.length)];
  curLetters=curWord.split('');curSlot=0;
  // scramble
  const scrambled=[...curLetters];
  for(let i=scrambled.length-1;i>0;i--){const j=Math.floor(Math.random()*(i+1));[scrambled[i],scrambled[j]]=[scrambled[j],scrambled[i]]}
  // make sure it's actually scrambled
  if(scrambled.join('')===curWord&&scrambled.length>1){[scrambled[0],scrambled[1]]=[scrambled[1],scrambled[0]]}

  const slots=document.getElementById('letterSlots');slots.innerHTML='';
  curLetters.forEach(()=>{const d=document.createElement('div');d.className='letter-slot';slots.appendChild(d)});

  const choices=document.getElementById('letterChoices');choices.innerHTML='';
  scrambled.forEach((l,i)=>{
    const b=document.createElement('button');b.className='letter-btn';b.textContent=l;b.dataset.idx=i;
    b.onclick=()=>pickLetter(l,b);
    choices.appendChild(b);
  });
}
function pickLetter(l,btn){
  const slots=document.querySelectorAll('.letter-slot');
  if(curSlot>=curLetters.length)return;
  const expected=curLetters[curSlot];
  const slot=slots[curSlot];
  slot.textContent=l;slot.classList.add('filled');
  if(l===expected){
    slot.classList.add('correct');btn.classList.add('used');curSlot++;
    if(curSlot>=curLetters.length){
      setTimeout(()=>transitionTo('Perfekt! üíå Letzte Challenge...','game3Page',1200),600);
      setTimeout(initGame3,1800);
    }
  } else {
    slot.classList.add('wrong');vib();
    setTimeout(()=>{slot.textContent='';slot.classList.remove('filled','wrong')},500);
  }
}

/* --- GAME 3: CONNECT-THE-DOTS HEART --- */
let dots=[],curDot=0,canvasCtx;
function initGame3(){
  const canvas=document.getElementById('drawCanvas');
  const size=Math.min(canvas.parentElement.clientWidth,320);
  canvas.width=size;canvas.height=size;
  canvasCtx=canvas.getContext('2d');
  // Heart shape dots
  const cx=size/2,cy=size/2,sc=size/2.8;
  const heartPoints=[];
  for(let a=0;a<Math.PI*2;a+=Math.PI*2/14){
    const x=16*Math.pow(Math.sin(a),3);
    const y=-(13*Math.cos(a)-5*Math.cos(2*a)-2*Math.cos(3*a)-Math.cos(4*a));
    heartPoints.push({x:cx+x*sc/16,y:cy+y*sc/16});
  }
  dots=heartPoints;curDot=0;
  document.getElementById('dotTotal').textContent=dots.length;
  document.getElementById('dotCount').textContent='0';
  drawDots();
  canvas.onclick=canvas.ontouchstart=function(e){
    e.preventDefault();
    const rect=canvas.getBoundingClientRect();
    const touch=e.touches?e.touches[0]:e;
    const mx=touch.clientX-rect.left,my=touch.clientY-rect.top;
    const d=dots[curDot];
    const dist=Math.sqrt((mx-d.x)**2+(my-d.y)**2);
    if(dist<25){
      curDot++;
      document.getElementById('dotCount').textContent=curDot;
      drawDots();
      if(curDot>=dots.length){
        // draw final line to close
        drawDots();
        setTimeout(()=>transitionTo('Wundersch√∂n! üé® Jetzt kommen die Fragen...','quizPage',1500),600);
        setTimeout(()=>{curQ=0;renderQ()},2200);
      }
    }
  };
}
function drawDots(){
  const ctx=canvasCtx,w=ctx.canvas.width,h=ctx.canvas.height;
  ctx.clearRect(0,0,w,h);
  // Draw connected lines
  if(curDot>0){
    ctx.beginPath();ctx.moveTo(dots[0].x,dots[0].y);
    for(let i=1;i<curDot;i++)ctx.lineTo(dots[i].x,dots[i].y);
    if(curDot>=dots.length)ctx.closePath();
    ctx.strokeStyle='#ff4d6d';ctx.lineWidth=3;ctx.lineCap='round';ctx.lineJoin='round';ctx.stroke();
    // fill if complete
    if(curDot>=dots.length){ctx.fillStyle='rgba(255,77,109,.15)';ctx.fill()}
  }
  // Draw dots
  dots.forEach((d,i)=>{
    ctx.beginPath();ctx.arc(d.x,d.y,i===curDot?10:5,0,Math.PI*2);
    if(i<curDot){ctx.fillStyle='#c9184a';ctx.fill()}
    else if(i===curDot){
      ctx.fillStyle='rgba(255,77,109,.2)';ctx.fill();
      ctx.beginPath();ctx.arc(d.x,d.y,6,0,Math.PI*2);
      ctx.fillStyle='#ff4d6d';ctx.fill();
      // glow
      ctx.beginPath();ctx.arc(d.x,d.y,13,0,Math.PI*2);
      ctx.strokeStyle='rgba(255,77,109,.4)';ctx.lineWidth=2;ctx.stroke();
    } else {
      ctx.fillStyle='#ffb3c6';ctx.fill();
    }
    // number
    ctx.fillStyle=i<curDot?'#fff':i===curDot?'#fff':'#c9184a';
    ctx.font='bold 9px Quicksand';ctx.textAlign='center';ctx.textBaseline='middle';
    ctx.fillText(i+1,d.x,d.y);
  });
}

/* ===== QUIZ ===== */
function renderQ(){
  const q=D.questions[curQ],t=D.questions.length;
  document.getElementById('progLbl').textContent=`Frage ${curQ+1} von ${t}`;
  document.getElementById('progFill').style.width=(curQ/t*100)+'%';
  document.getElementById('qNum').textContent=`Frage ${curQ+1}`;
  document.getElementById('qText').textContent=q.text;
  const g=document.getElementById('aGrid');g.innerHTML='';
  q.answers.forEach((a,i)=>{
    const b=document.createElement('button');b.className='a-btn';b.textContent=a;
    b.onclick=()=>selAns(i);b.style.animation=`fadeInUp .4s ease-out ${i*.1}s both`;
    g.appendChild(b);
  });
  document.getElementById('qCard').classList.remove('shake','wrong');
}
function selAns(idx){
  const q=D.questions[curQ],bs=document.querySelectorAll('.a-btn'),c=document.getElementById('qCard');
  bs.forEach(b=>b.style.pointerEvents='none');
  if(idx===q.correct){
    bs[idx].classList.add('correct');
    setTimeout(()=>{curQ++;
      if(curQ>=D.questions.length){document.getElementById('progFill').style.width='100%';setTimeout(()=>{showP('rewardPage');confettiGo()},400)}
      else renderQ();
    },800);
  } else {
    bs[idx].classList.add('incorrect');c.classList.add('shake','wrong');vib();
    setTimeout(()=>{bs.forEach(b=>{b.classList.remove('incorrect');b.style.pointerEvents='auto'});c.classList.remove('shake','wrong')},1200);
  }
}

function vib(){if(navigator.vibrate)navigator.vibrate([100,50,100])}

function confettiGo(){
  const cols=['#c9184a','#ff4d6d','#ffb3c6','#d4a373','#e9c46a','#ff758f'];
  for(let i=0;i<60;i++){setTimeout(()=>{
    const p=document.createElement('div');p.className='confetti';
    p.style.left=Math.random()*100+'vw';p.style.width=(6+Math.random()*8)+'px';
    p.style.height=(6+Math.random()*8)+'px';p.style.backgroundColor=cols[Math.floor(Math.random()*cols.length)];
    p.style.borderRadius=Math.random()>.5?'50%':'2px';p.style.animationDuration=(2+Math.random()*3)+'s';
    document.body.appendChild(p);setTimeout(()=>p.remove(),5000);
  },i*40)}
}

/* ===== ADMIN ===== */
function popAdmin(){
  document.getElementById('admTitle').value=D.welcomeTitle;
  document.getElementById('admSub').value=D.welcomeSubtitle;
  document.getElementById('admGift').value=D.giftText;
  document.getElementById('admPwQuiz').value=D.quizPassword;
  document.getElementById('admPwAdmin').value=D.adminPassword;
  renderQList();
}
function renderQList(){
  const l=document.getElementById('qList');l.innerHTML='';
  D.questions.forEach((q,i)=>{
    const d=document.createElement('div');d.className='q-item';
    const ah=q.answers.map((a,ai)=>ai===q.correct?`<span class="ca">‚úì ${a}</span>`:a).join(' ¬∑ ');
    d.innerHTML=`<div class="q-item-head"><span class="q-item-num">Frage ${i+1}</span><div class="q-item-acts">
      <button class="btn btn-s btn-sm" onclick="editQ(${i})">‚úèÔ∏è</button>
      <button class="btn btn-d btn-sm" onclick="delQ(${i})">üóë</button>
      ${i>0?`<button class="btn btn-s btn-sm" onclick="moveQ(${i},-1)">‚Üë</button>`:''}
      ${i<D.questions.length-1?`<button class="btn btn-s btn-sm" onclick="moveQ(${i},1)">‚Üì</button>`:''}
    </div></div><div class="q-item-text">${q.text}</div><div class="q-item-ans">${ah}</div>`;
    l.appendChild(d);
  });
}
function showAddForm(){editIdx=-1;document.getElementById('fqText').value='';document.getElementById('qForm').classList.add('show');const c=document.getElementById('fAnswers');c.innerHTML='';addAField();addAField();document.getElementById('qForm').scrollIntoView({behavior:'smooth'})}
function editQ(i){editIdx=i;const q=D.questions[i];document.getElementById('fqText').value=q.text;const c=document.getElementById('fAnswers');c.innerHTML='';q.answers.forEach((a,ai)=>addAField(a,ai===q.correct));document.getElementById('qForm').classList.add('show');document.getElementById('qForm').scrollIntoView({behavior:'smooth'})}
function addAField(v='',cor=false){const c=document.getElementById('fAnswers'),idx=c.children.length,r=document.createElement('div');r.className='a-row';r.innerHTML=`<input type="radio" name="corAns" value="${idx}" ${cor?'checked':''}><input type="text" value="${v}" placeholder="Antwort ${idx+1}..."><button class="rm-btn" onclick="this.parentElement.remove()">√ó</button>`;c.appendChild(r)}
function saveQ(){
  const text=document.getElementById('fqText').value.trim();if(!text){toast('Bitte Frage eingeben!');return}
  const rows=document.querySelectorAll('#fAnswers .a-row'),answers=[];let correct=-1;
  rows.forEach(r=>{const t=r.querySelector('input[type="text"]').value.trim(),ch=r.querySelector('input[type="radio"]').checked;if(t){if(ch)correct=answers.length;answers.push(t)}});
  if(answers.length<2){toast('Mindestens 2 Antworten!');return}
  if(correct===-1){toast('Richtige Antwort ausw√§hlen!');return}
  if(editIdx>=0)D.questions[editIdx]={text,answers,correct};else D.questions.push({text,answers,correct});
  cancelForm();renderQList();toast('Frage gespeichert!');
}
function cancelForm(){document.getElementById('qForm').classList.remove('show');editIdx=-1}
function delQ(i){if(confirm('Frage wirklich l√∂schen?')){D.questions.splice(i,1);renderQList();toast('Gel√∂scht!')}}
function moveQ(i,d){const n=i+d;if(n<0||n>=D.questions.length)return;[D.questions[i],D.questions[n]]=[D.questions[n],D.questions[i]];renderQList()}
function saveAll(){
  D.welcomeTitle=document.getElementById('admTitle').value.trim()||DEFAULTS.welcomeTitle;
  D.welcomeSubtitle=document.getElementById('admSub').value.trim()||DEFAULTS.welcomeSubtitle;
  D.giftText=document.getElementById('admGift').value.trim()||DEFAULTS.giftText;
  D.quizPassword=document.getElementById('admPwQuiz').value.trim()||DEFAULTS.quizPassword;
  D.adminPassword=document.getElementById('admPwAdmin').value.trim()||DEFAULTS.adminPassword;
  apply();const ok=sSet('vq_data',D);
  if(ok){const s=document.getElementById('saveSt');s.classList.add('v');setTimeout(()=>s.classList.remove('v'),2000);toast('Alles gespeichert! ‚ô•')}
  else toast('Fehler beim Speichern!');
}
function preview(){saveAll();setTimeout(()=>showP('welcomePage'),300)}
function logout(){showP('passwordPage');document.getElementById('pwIn').value=''}

function toast(m){const t=document.getElementById('toast');t.textContent=m;t.classList.add('show');setTimeout(()=>t.classList.remove('show'),2500)}

/* Hearts BG */
!function(){const bg=document.getElementById('hbg'),h=['‚ô•','‚ô°','‚ù§','üíï','üíó'];for(let i=0;i<20;i++){const s=document.createElement('span');s.className='fh';s.textContent=h[Math.floor(Math.random()*h.length)];s.style.left=Math.random()*100+'%';s.style.fontSize=(.8+Math.random()*1.2)+'rem';s.style.animationDuration=(8+Math.random()*12)+'s';s.style.animationDelay=(Math.random()*15)+'s';bg.appendChild(s)}}();

/* Init */
loadData();
document.getElementById('pwIn').addEventListener('keydown',e=>{if(e.key==='Enter')checkPw()});
</script>
</body>
</html>
